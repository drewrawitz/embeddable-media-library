{"version":3,"file":"imagekit-media-library-widget.esm.js","sources":["../node_modules/rollup-plugin-styles/dist/runtime/inject-css.js","../src/index.js"],"sourcesContent":["var e=[],t=[];function n(n,r){if(n&&\"undefined\"!=typeof document){var a,s=!0===r.prepend?\"prepend\":\"append\",d=!0===r.singleTag,i=\"string\"==typeof r.container?document.querySelector(r.container):document.getElementsByTagName(\"head\")[0];if(d){var u=e.indexOf(i);-1===u&&(u=e.push(i)-1,t[u]={}),a=t[u]&&t[u][s]?t[u][s]:t[u][s]=c()}else a=c();65279===n.charCodeAt(0)&&(n=n.substring(1)),a.styleSheet?a.styleSheet.cssText+=n:a.appendChild(document.createTextNode(n))}function c(){var e=document.createElement(\"style\");if(e.setAttribute(\"type\",\"text/css\"),r.attributes)for(var t=Object.keys(r.attributes),n=0;n<t.length;n++)e.setAttribute(t[n],r.attributes[t[n]]);var a=\"prepend\"===s?\"afterbegin\":\"beforeend\";return i.insertAdjacentElement(a,e),e}}export default n;\n","'use strict';\nimport styles from './styles.css'\n\nfunction ImagekitMediaLibraryWidget() {\n  var IK_HOST = 'https://eml.imagekit.io';\n  var IK_SRC = `${IK_HOST}/media-library-widget?redirectTo=media-library-widget&isMediaLibraryWidget=true`;\n  var IK_FRAME_TITLE = 'ImageKit Embedded Media Library';\n  var callbackFunction;\n  var view = \"modal\";\n\n  // Define constructor \n  var IKMediaLibraryWidget = function () {\n    // Create global element references\n    this.security = null;\n    this.widgetHost = window.location.href;\n\n    // Define option defaults \n    var defaults = {\n      className: \"\",\n      container: \"\",\n      containerDimensions: {\n        height: '100%',\n        width: '100%'\n      },\n      dimensions: {\n        height: '100%',\n        width: '100%'\n      },\n      style: {\n        border: 'none'\n      },\n      view: 'modal',\n      renderOpenButton: true,\n    };\n\n    // Create options by extending defaults with the passed in arugments\n    if (arguments[0] && typeof arguments[0] === \"object\") {\n      this.options = Object.assign({}, defaults, arguments[0]);\n    }\n\n    // Set callback function\n    if (arguments[1] && typeof arguments[1] === \"function\") {\n      this.callback = arguments[1];\n      callbackFunction = this.callback;\n    }\n\n    view = this.options.view;\n    this.init();\n  }\n\n  IKMediaLibraryWidget.prototype.init = function () {\n    buildOut.call(this);\n  }\n\n  var button, modal, modalContent; // modal-only elements\n\n  function buildOut() {\n    var container, docFragment, mainFrame; // common elements\n\n    // If container is an HTML string, find the DOM node, else use it directly.\n    if (typeof this.options.container === \"string\") {\n      container = document.querySelector(this.options.container);\n    } else {\n      container = this.options.container;\n    }\n\n    // Create a DocumentFragment to build with\n    docFragment = document.createDocumentFragment();\n\n    // Create ikFrame element\n    this.ikFrame = document.createElement(\"div\");\n    this.ikFrame.className = this.options.className;\n    this.ikFrame.style.height = this.options.containerDimensions.height;\n    this.ikFrame.style.width = this.options.containerDimensions.width;\n    this.ikFrame.callback = this.callback;\n\n    mainFrame = document.createElement(\"iframe\");\n    mainFrame.title = IK_FRAME_TITLE;\n    mainFrame.src = `${IK_SRC}&widgetHost=${this.widgetHost}`;\n    mainFrame.sandbox = 'allow-top-navigation allow-same-origin allow-scripts allow-forms allow-modals allow-popups';\n    mainFrame.height = this.options.dimensions.height;\n    mainFrame.width = this.options.dimensions.width;\n    mainFrame.style.border = this.options.style.border;\n\n    this.ikFrame.appendChild(mainFrame);\n\n    if (this.options.view.toLowerCase() !== 'modal') {\n      // Append ikFrame to DocumentFragment\n      docFragment.appendChild(this.ikFrame);\n\n      // Append DocumentFragment to body\n      container.appendChild(docFragment);\n    } else {\n      if (this.options.renderOpenButton) {\n        // create button\n        button = document.createElement(\"button\");\n        button.innerHTML = \"Open Media Library\";\n        button.onclick = function () {\n          modal.style.display = \"block\";\n        }\n      }\n\n      // create modal\n      modal = document.createElement(\"div\");\n      modalContent = document.createElement(\"div\");\n      modal.classList.add(\"ik-media-library-widget-modal\");\n      modalContent.classList.add(\"ik-media-library-widget-modal-content\");\n      modalContent.appendChild(this.ikFrame);\n      modal.appendChild(modalContent);\n\n      // append button and modal to docFragment\n      if (this.options.renderOpenButton) {\n        docFragment.appendChild(button);\n      }\n      docFragment.appendChild(modal);\n\n      // append docFragment to container\n      container.appendChild(docFragment);\n    }\n  }\n\n  function close() {\n    if (view.toLowerCase() === 'modal') {\n      closeModal();\n    }\n  }\n\n  function closeModal() {\n    modal.style.display = \"none\";\n  }\n\n  window.onclick = function (event) {\n    if (event.target == modal) {\n      close();\n    }\n  }\n\n  // Called sometime after postMessage is called\n  window.addEventListener(\"message\", function (event) {\n    if (event.origin !== IK_HOST) {\n      return;\n    }\n\n    if (event.data.eventType === \"CLOSE_MEDIA_LIBRARY_WIDGET\" || event.data.eventType === \"INSERT\") {\n      callbackFunction(event.data);\n      close();\n    }\n  });\n\n  return window.IKMediaLibraryWidget = IKMediaLibraryWidget;\n}\n\nexport default ImagekitMediaLibraryWidget();\n"],"names":["e","t","n","r","document","a","s","prepend","d","singleTag","i","container","querySelector","getElementsByTagName","u","indexOf","push","c","charCodeAt","substring","styleSheet","cssText","appendChild","createTextNode","createElement","setAttribute","attributes","Object","keys","length","insertAdjacentElement","callbackFunction","button","modal","modalContent","IK_HOST","IK_SRC","view","IKMediaLibraryWidget","security","widgetHost","window","location","href","defaults","className","containerDimensions","height","width","dimensions","style","border","renderOpenButton","arguments","_typeof","options","assign","callback","this","init","buildOut","docFragment","mainFrame","createDocumentFragment","ikFrame","title","src","sandbox","toLowerCase","innerHTML","onclick","display","classList","add","close","prototype","call","event","target","addEventListener","origin","data","eventType","ImagekitMediaLibraryWidget"],"mappings":"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"}